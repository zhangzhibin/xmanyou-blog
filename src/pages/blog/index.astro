---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
---

<Layout title="Blog - All Posts" description="博客文章列表">
  <h1>All Posts</h1>
  <ul>
    {
      (await getCollection('blog', ({ data }) => !data.draft && data.type === 'post'))
        .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
        .map((entry) => (
          <li>
            <a href={`/blog/${(entry.data.slug || entry.id || '').replace(/\.mdx?$/, '')}/`}>
              {entry.data.title}
            </a>
            <span> — {entry.data.author}</span>
            <time datetime={entry.data.pubDate.toISOString()}>
              {entry.data.pubDate.toLocaleDateString('zh-CN')}
            </time>
          </li>
        ))
    }
  </ul>
</Layout>
