---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';
---

<Layout title="Blog" description="影子工作室博客">
  <h1>Blog</h1>
  <ul>
    {
      (await getCollection('blog', ({ data }) => !data.draft && data.type === 'post'))
        .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
        .slice(0, 20)
        .map((entry) => (
          <li>
            <a href={`/blog/${(entry.data.slug || entry.id || '').replace(/\.mdx?$/, '')}/`}>
              {entry.data.title}
            </a>
            <time datetime={entry.data.pubDate.toISOString()}>
              {entry.data.pubDate.toLocaleDateString('zh-CN')}
            </time>
          </li>
        ))
    }
  </ul>
  <p><a href="/blog/">View all posts →</a></p>
</Layout>
